<html>

<head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <title>Tour and Hotel Recommendation</title>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <!-- css  -->
    <link rel="stylesheet" href="public/css/sty.css">
    <script type="text/javascript" src="./public/javascript/nav.js"></script>


</head>

<body>

    <nav class="nav">
        <div class="container">

            <h1 class="logog"><a href="#container">Mywebsite</a> </h1>
            <ul>
                <li><a href="#banner" class="current">Home</a></li>
                <li><a href="#about">About Us</a></li>
                <li><a href="#tour">Tours</a></li>
                <li><a href="#media">Media</a></li>
                <li><a href="#contact">Contact Us</a></li>
                <li ><a id="nameorlogin" href="./Login.html">Login</a></li>
                <li ><a id="addtour"   style="display: none;"  href="./addtour.html">Add tour</a></li>
                <li ><a id="adduser"  style="display: none;"  href="./SignUp.html">Add Admin</a></li>
                <li ><a id="addguide"   style="display: none;"  href="./addguide.html">Add Guide</a></li>
                <li ><a id="tours"   style="display: none;"  href="./tours.html"> Your Tours</a></li>
                <li ><a id="guides"   style="display: none;"  href="./guides.html"> Your Guides</a></li>
            </ul>
            <div class="btn-group">
                <a href="recommend.html" class="btn btn-try">
                    Recommended Tours
                </a>
            </div>
        </div>
    </nav>

    <!-- main  -->
    <main>

        <!-- banner  -->

        <section class="banner" id="banner">
            <div class="banner-text">
                <h1>Tour and Hotel Recommendation</h1>
                <P>Tour and Hotel Recommendation provides u the best tourism places. Book online.</P>
                <a href="#" class="btn btn-get"><span>Explore</span></a>
            </div>
            <div class="overlay2">

            </div>
        </section>
        <!-- explore  -->
        <section class="explore" id="explore">
            <div class="main-text">
                <h2>Explore</h2>
                <h1><span>I</span>ce World</h1>
                <p>This place amazes with its fabulous atmosphere and nature</p>
            </div>
            <div class="main-container" >
                <div class="image-box image-1">
                    <img src="https://images.unsplash.com/photo-1603226851957-1768f812309b?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=870&q=80"
                        alt="">
                    <div class="overlay"></div>
                    <div class="image-box-text">
                        <h2>Kathmandu</h2>
                        <p>Capital city of Nepal</p>
                    </div>
                </div>
                <div class="image-box image-1">
                    <img src="https://images.unsplash.com/photo-1534804101463-987ef0c79d54?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=870&q=80"
                        alt="">
                    <div class="overlay"></div>
                    <div class="image-box-text">
                        <h2>Everest</h2>
                        <p>Highest Mountain</p>
                    </div>
                </div>
                <div class="image-box image-1">
                    <img src="https://images.unsplash.com/photo-1556554883-5701482655e0?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=580&q=80"
                        alt="">
                    <div class="overlay"></div>
                    <div class="image-box-text">
                        <h2>Pokhara</h2>
                        <p>Phewa Lake</p>
                    </div>
                </div>
            </div>
            <button class="btn btn-view-all">
                View More
            </button>
        </section>

        <!-- about  -->
        <section class="about" id="about">
            <div class="main-text">
                <h2>About</h2>
                <h1>Unforgettable <span>S</span>ensations</h1>
                <p>Iceland adventure is a tours of the best places in iceland. We will help make your trip perfect, find
                    the chepest tickets, Book the best hotels Nothing will stop you from enjoying the atmosphere of the
                    ice country.</p>
            </div>
            <div class="main-container">
                <video
                    src="https://assets.mixkit.co/videos/preview/mixkit-aerial-view-of-lush-river-valley-and-snowy-mountains-15919-large.mp4"
                    autoplay loop muted></video>
            </div>
            <!-- tour  -->

            <section class="tour" id="tour">
                <div class="main-text">
                    <h2>2021</h2>
                    <h1>Tours</h1>
                </div>
                <div class="main-container" id="main-container">
                    <!-- // card 1 -->
                    
                    <!-- ------ -->
                    <!-- card 2 -->
                    
                    <!-- ------  -->

                    <!-- cards 3  -->
                    <div class="tour-cards">
                        <div class="image-box">
                            <img src="https://images.unsplash.com/photo-1491466424936-e304919aada7?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=869&q=80"
                                alt="Stakkholtsgja canyon ">
                            <div class="overlay"></div>
                            <div class="image-box-text">
                                <h2>Stakkholtsgja</h2>
                                <p>Mountains & Waterfall</p>
                            </div>

                        </div>
                        <div class="tour-cards-text">
                            <h1>Stakkholtsgja canyon Trip</h1>
                            <p>A Week long trip around the south iceland with hiking guides. Stakkholtsgj√° is a wondrous
                                canyon, situated in Southern part of the Icelandic Highlands. It is highly-known for the
                                magical hiking trail that leads to a majestic waterfall. The gorge is a part of the
                                √û√≥rsm√∂rk
                                Nature Reserve. Every bit
                                of Stakkholtsgj√° canyon shines out with picturesque beauty. Stakkholtsgj√° is about a
                                hundred
                                meters deep.</p>
                            <a href="#" class="btn-map">

                                <span>View Route Map</span>
                            </a>
                            <div class="price">
                                <p>$5200 <span>Per person</span></p>
                                <h2>18 Days 36 Nights</h2>
                            </div>
                        </div>
                    </div>
                    <!-- ------ -->
                </div>
                <button class="btn btn-view-all">
                    View More
                </button>
            </section>

            <!-- <section class="sale" id="sale">
                <div class="overlay1">

                </div>
                <div class="main-container">
                    <div class="heading">
                        <h1>Iceland Glow</h1>
                        <h2>Sale</h2>
                    </div>
                    <div class="info">
                        <p>
                            Tours run from September to aprill when the forecast is favourable. Experts will take care
                            of
                            every
                            thing they know
                            where to look for the northern lights how to photograph it,how to move to where the forecast
                            is
                            most
                            likely and the
                            clouds are least of all.
                        </p>
                    </div>
                    <div class="price">
                        <p>$2400<span>Per person</span></p>
                        <h2>15 Days 14 Nights</h2>
                    </div>
                </div>
                <div class="overlay2">

                </div>
            </section> -->

            <!-- ----- -->
            <!-- media  -->

            <section class="media" id="media">
                <div class="main-text">
                    <h2>Media</h2>
                    <h1>Iceland in Footage</h1>
                </div>
                <div class="main-container">
                    <div class="image image-1">
                        <img src="https://images.unsplash.com/photo-1617191979724-f755c6d83e01?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=871&q=80"
                            alt="Erupting Volcano">
                        <h3>Erupting Volcano</h3>
                    </div>
                    <div class="image image-2">
                        <img src="https://images.unsplash.com/photo-1516832970803-325be7a92aa5?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=871&q=80"
                            alt="Icelandic horses ">
                        <h3>Icelandic horses</h3>
                    </div>
                    <div class="image image-3">
                        <img src="https://images.unsplash.com/photo-1489782419474-4d4221dc5b10?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=870&q=80"
                            alt="Hv√≠tserkur">
                        <h3>Hv√≠tserkur</h3>
                    </div>
                    <div class="image image-4">
                        <img src="https://images.unsplash.com/photo-1540503831458-3237544b2ce5?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1141&q=80"
                            alt="Flatey village">
                        <h3>Flatey village</h3>
                    </div>
                    <div class="image image-5">
                        <img src="https://images.unsplash.com/photo-1512419180521-2c5585bdf851?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=870&q=80"
                            alt="Parliament of Puffins">
                        <h3>Parliament of Puffins</h3>
                    </div>
                    <div class="image image-6">
                        <img src="https://images.unsplash.com/photo-1551098955-f124915c1ff3?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1470&q=80"
                            alt=" Iceland Beach">
                        <h3>Iceland Beach</h3>
                    </div>
                    <div class="image image-7">
                        <img src="https://images.unsplash.com/photo-1615130767419-e9ff3afa5a15?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1054&q=80"
                            alt="Reykjav√≠k City">
                        <h3>Reykjav√≠k City</h3>
                    </div>
                    <div class="image image-8">
                        <img src="https://images.unsplash.com/photo-1477442229003-02551413eaad?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=870&q=80"
                            alt="Skogafoss Waterfall">
                        <h3>Skogafoss Waterfall</h3>
                    </div>
                    <div class="image image-9">
                        <img src="https://images.unsplash.com/photo-1572587356426-b33bf42f999b?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=871&q=80"
                            alt="Iceland Caves">
                        <h3>Iceland Caves</h3>
                    </div>
                    <div class="image image-10">
                        <img src="https://images.unsplash.com/photo-1525624160868-97095e12e633?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=869&q=80"
                            alt="Gigj√∂kull">
                        <h3>Gigj√∂kull</h3>
                    </div>
                    <div class="image image-11">
                        <img src="https://images.unsplash.com/photo-1475518845976-0fd87b7e4e5d?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=870&q=80"
                            alt="Aurora">
                        <h3>Aurora</h3>
                    </div>
                    <div class="image image-12">
                        <img src="https://images.unsplash.com/photo-1536007379435-ba39ac15caae?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=886&q=80"
                            alt="Solheimasandur Plane Wreck">
                        <h3>Solheimasandur Plane Wreck</h3>
                    </div>
                </div>
            </section>

            <!-- ----- -->

            <!-- contact  -->
            <section class="contact" id="contact">
                <div class="main-text">
                    <h2>Contact</h2>
                    <h1>Get in touch</h1>
                </div>
                <div class="main-container">
                    <form action="#">
                        <div class="name">
                            <label for="name">Name</label>
                            <input type="text" placeholder="Enter Your name " id="name" name="name">
                        </div>
                        <div class="phone">
                            <label for="phone">Email or Phone</label>
                            <input type="text" name="phone" id="phone" placeholder="Enter Your Number or phone">
                        </div>
                        <div class="message">
                            <label for="message">Your message</label>
                            <textarea name="message" id="message" cols="30" rows="10"
                                placeholder="Tell us about your interests passion needs and any other details relevent to your trip"></textarea>
                        </div>
                        <button class="btn-send">
                            Send
                        </button>
                    </form>
                </div>
            </section>

            <!-- ----- -->
    </main>

    <!-- footer -->
    <footer>
        <div class="footer-image">
            <div class="overlay1"></div>
            <div class="overlay2"></div>

        </div>
        <div class="main-container">
            <div class="heading-foo">
                <img src="public/images/logo/iceland.svg" alt="">
                <h1>Iceland</h1>
                <p>EVERYTHING IS EXPENSIVE IN ICELAND, ESPECIALLY FOOD, AND ESPECIALLY HEALTHY FOOD</p>
            </div>
            <div class="social-media">
                <h1>Connect with us</h1>
                <ul>
                    <li>
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="fill">
                            <path
                                d="M9 8h-3v4h3v12h5v-12h3.642l.358-4h-4v-1.667c0-.955.192-1.333 1.115-1.333h2.885v-5h-3.808c-3.596 0-5.192 1.583-5.192 4.615v3.385z" />
                        </svg>
                    </li>
                    <li>
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="fill">
                            <path
                                d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z" />
                        </svg>
                    </li>
                    <li>
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="fill">
                            <path
                                d="M19.615 3.184c-3.604-.246-11.631-.245-15.23 0-3.897.266-4.356 2.62-4.385 8.816.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23 0 3.897-.266 4.356-2.62 4.385-8.816-.029-6.185-.484-8.549-4.385-8.816zm-10.615 12.816v-8l8 3.993-8 4.007z" />
                        </svg>
                    </li>
                </ul>
            </div>
            <div class="main">
                <h1>Quick Links</h1>
                <ul>
                    <li><a href="#explore">Explore</a></li>
                    <li><a href="#about">About</a></li>
                    <li><a href="#tour">Tours</a></li>
                    <li><a href="#media">Media</a></li>
                </ul>
            </div>
            <div class="contact-info">
                <h1>Contacts</h1>
                <div class="contact-info-text">
                    <p>+977-9842411394</p>
                    <p>tourandhotel@help.com</p>
                </div>
            </div>
        </div>
        <div class="credit">
            <h3>üñ•Ô∏è Design and Developed By <a href="">Team ABD</a></h3>
        </div>
    </footer>

    </section>




</body>
     <script>
       const getuserid  = async () =>{
            try{
                const response =  await fetch('http://localhost:3000/api/v1/users/getuserfromtoken', {
                                method: 'POST',
                                headers: {
                                    'Content-Type': 'application/json'
                                },
                                body: JSON.stringify({
                                    token:getCookie('token')
                                })
                            })
                const data =  await response.json()
                return data
            }
            catch(err){
                console.log(err)
            }
        } 
        function deleteCookie(name) {
            document.cookie = name + '=;expires=Thu, 01 Jan 1970 00:00:01 GMT;';
        }                  
        const resultsDiv = document.getElementById('main-container')
        
        fetch('http://localhost:3000/api/v1/tours',{
            method:'GET'
        })
            .then(response => response.json())
            .then(data => {
        
        
            data.data.forEach(async tour => {
                const tourDiv = document.createElement('div');
tourDiv.classList.add('tour-cards');

const imageBox = document.createElement('div');
imageBox.classList.add('image-box');

const image = document.createElement('img');
image.setAttribute('src', 'https://images.unsplash.com/photo-1491466424936-e304919aada7?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=869&q=80');
image.setAttribute('alt', 'Stakkholtsgja canyon ');

const overlay = document.createElement('div');
overlay.classList.add('overlay');

const imageBoxText = document.createElement('div');
imageBoxText.classList.add('image-box-text');

const h2 = document.createElement('h2');
h2.textContent = 'Stakkholtsgja';

const p = document.createElement('p');
p.textContent = 'Mountains & Waterfall';

imageBoxText.appendChild(h2);
imageBoxText.appendChild(p);

imageBox.appendChild(image);
imageBox.appendChild(overlay);
imageBox.appendChild(imageBoxText);

const tourCardsText = document.createElement('div');
tourCardsText.classList.add('tour-cards-text');

const h1 = document.createElement('h1');
h1.textContent = tour.name;

const p2 = document.createElement('p');
p2.textContent = tour.summary;

const price = document.createElement('div');
price.classList.add('price');

const p3 = document.createElement('p');
p3.textContent = tour.price + ' ';
const span = document.createElement('span');
span.textContent = 'Per person';
p3.appendChild(span);

const h22 = document.createElement('h2');
h22.textContent = 'Duration:' + tour.duration;

price.appendChild(p3);
price.appendChild(h22);

tourCardsText.appendChild(h1);
tourCardsText.appendChild(p2);
tourCardsText.appendChild(price);
tourDiv.appendChild(imageBox);
tourDiv.appendChild(tourCardsText);        
const response =  await fetch(`http://localhost:3000/api/v1/tours/numberofbookings/${tour._id}`)
const data =  await response.json()
if(tour.maxGroupSize >= data){
    const button = document.createElement('button');
    button.addEventListener('click', function() {
    booktour(tour._id, tour.price);
    });
    button.textContent = 'Book Tour';
    tourDiv.appendChild(button);
}
else {
    const full = document.createElement('p')
    p.innerText = 'SEATS NOT AVAILABLE'
    tourDiv.appendChild(full)
}

               






      resultsDiv.appendChild(tourDiv);
    });
})
.catch(error => console.error(error));
function getCookie(name) {
    const cookieValue = document.cookie.match('(^|;)\\s*' + name + '\\s*=\\s*([^;]+)');
    return cookieValue ? cookieValue.pop() : '';
                
}
    
const ifloggedin  = async () =>{
    try{
        const response =  await fetch('http://localhost:3000/api/v1/users/getuserfromtoken', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            token:getCookie('token')
                        })
                    })
         const data =  await response.json()
       
         const namediv =  document.getElementById('nameorlogin')
         namediv.href = 'logout.html'
         namediv.innerHTML =  `Logout ${data.name}`
         namediv.addEventListener('click',() =>{
                    deleteCookie('token')
                    namediv.href = 'index.html'
         })
         const addtour = document.getElementById('addtour')
        const adduser = document.getElementById('adduser')
        const addguide = document.getElementById('addguide')
        const guides = document.getElementById('guides')
        const tours = document.getElementById('tours')
        if(data.role == 'admin'){
            console.log(data.role)
            addtour.style.display = "block";
            addguide.style.display ="block"
            guides.style.display ="block"
            tours.style.display ="block"

        }
        if(data.role == 'system-admin'){
            console.log(data.role)
            adduser.style.display = 'block'
        }
       }
       catch(err){
        console.log(err)
       }
}
if(getCookie('token')){
    console.log(getCookie('token'))
    ifloggedin()
}
function deleteCookie(name) {
  document.cookie = name + '=;expires=Thu, 01 Jan 1970 00:00:01 GMT;';
}
async function booktour(tour,price){
    const user = await getuserid()
    const userid = user._id
    const paid = false;
    try {
                    const response = await fetch('http://localhost:3000/api/v1/booking', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            tour,
                            userid,
                            price,
                            paid

                        })
                    });
    
                    const data = await response.json();
                   if(data){
                       alert('You have booked a tour')
                   }
                } catch (error) {
                    console.log(error);
                }
}
async function canceltour(tour,price){
    const user = await getuserid()
    const paid = false;
    try {
                    const response = await fetch('http://localhost:3000/api/v1/booking', {
                        method: 'DELETE',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            tour,
                            user,
                            price,
                            paid

                        })
                    });
    
                    const data = await response.json();
                    
                   console.log(data)
                } catch (error) {
                    console.log(error);
                }
}  
    
    
  
  
    </script>
</html>